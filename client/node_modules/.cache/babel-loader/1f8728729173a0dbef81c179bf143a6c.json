{"ast":null,"code":"import _objectSpread from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/alessio_barbiero/headlessCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';//import items from './data';\nimport Client from'./dataAPI';var ProductContext=React.createContext();var ProductProvider=/*#__PURE__*/function(_Component){_inherits(ProductProvider,_Component);var _super=_createSuper(ProductProvider);function ProductProvider(){var _this;_classCallCheck(this,ProductProvider);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={products:[],sortedProducts:[],onesToWatch:[],loading:true,type:\"all\",compatibility:\"all\",brand:\"all\",price:0,minPrice:0,maxPrice:0};_this.getData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,products,tempSorted,onesToWatch,minPrice,maxPrice,maxSize,price;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Client.getEntries({content_type:\"photoStudio\",order:\"fields.price\"});case 3:response=_context.sent;products=_this.formatData(response.items);tempSorted=products.sort(function(a,b){return a.price>b.price?1:-1;});onesToWatch=[tempSorted[0],tempSorted[1],tempSorted[2]];minPrice=Math.min.apply(Math,_toConsumableArray(products.map(function(item){return item.price;})));maxPrice=Math.max.apply(Math,_toConsumableArray(products.map(function(item){return item.price;})));maxSize=Math.max.apply(Math,_toConsumableArray(products.map(function(item){return item.size;})));price=maxPrice;_this.setState({products:products,sortedProducts:products,onesToWatch:onesToWatch,loading:false,maxPrice:maxPrice,minPrice:minPrice,maxSize:maxSize,price:price});_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));_this.sort=function(event){var sortedProducts=_this.state.sortedProducts;var value=event.target.value;if(value===\"alpha\")sortedProducts=sortedProducts.sort(function(a,b){return a.name>b.name?1:-1;});else if(value===\"price\")sortedProducts=sortedProducts.sort(function(a,b){return a.price>b.price?1:-1;});_this.setState({sortedProducts:sortedProducts});};_this.getProduct=function(element){var tempProduct=_toConsumableArray(_this.state.products);var product=tempProduct.find(function(product){return product.element===element;});return product;};_this.resetChanges=function(event){var products=_this.state.products;_this.setState({sortedProducts:products});};_this.handleChanges=function(event){var target=event.target;var value=target.type==='checkbox'?target.checked:target.value;var name=event.target.name;_this.setState(_defineProperty({},name,value),_this.filterProducts);};_this.filterProducts=function(){var _this$state=_this.state,products=_this$state.products,type=_this$state.type,compatibility=_this$state.compatibility,price=_this$state.price,brand=_this$state.brand;var tempProducts=_toConsumableArray(products);//capacity\nif(compatibility!=='all')tempProducts=tempProducts.filter(function(product){return product.compatibility.includes(compatibility);});//type\nif(type!=='all')tempProducts=tempProducts.filter(function(product){return product.type===type;});//price\nprice=parseInt(price);tempProducts=tempProducts.filter(function(product){return product.price<=price;});//brand\nif(brand!=='all')tempProducts=tempProducts.filter(function(product){return product.brand===brand;});_this.setState({sortedProducts:tempProducts});};return _this;}_createClass(ProductProvider,[{key:\"componentDidMount\",//getData\nvalue:function componentDidMount(){var express=require('express');var cors=require('cors');var app=express();var fetch=require('node-fetch');app.use(cors());app.get(/*'https://ghibliapi.herokuapp.com/films'*/'https://nhmagqf3.api.commercecloud.salesforce.com/product/shopper-products/v1/organizations/f_ecom_bcld_s02/products').then(function(res){return res.json();}).then(function(data){console.log(data);}).catch(function(e){console.log(e);});this.getData();}//componentDidMount\n},{key:\"formatData\",//sort\nvalue:function formatData(items){var tempItems=items.map(function(item){var id=item.sys.id;var images=item.fields.images.map(function(image){return image.fields.file.url;});var product=_objectSpread(_objectSpread({},item.fields),{},{images:images,id:id});return product;});return tempItems;}//formatData\n},{key:\"render\",//filterProducts\nvalue:function render(){return/*#__PURE__*/React.createElement(ProductContext.Provider,{value:_objectSpread(_objectSpread({},this.state),{},{getProduct:this.getProduct,handleChanges:this.handleChanges,resetChanges:this.resetChanges,sort:this.sort})},this.props.children);}//render\n}]);return ProductProvider;}(Component);//ProductProvider\nexport{ProductProvider as default};var ProductConsumer=ProductContext.Consumer;export function withProductConsumer(Component){return function ConsumerWrapper(props){return/*#__PURE__*/React.createElement(ProductConsumer,null,function(value){return/*#__PURE__*/React.createElement(Component,Object.assign({},props,{context:value}));});};}//withProductConsumer\nexport{ProductProvider,ProductConsumer,ProductContext};","map":{"version":3,"sources":["/home/alessio_barbiero/headlessCommerce/src/context.js"],"names":["React","Component","Client","ProductContext","createContext","ProductProvider","state","products","sortedProducts","onesToWatch","loading","type","compatibility","brand","price","minPrice","maxPrice","getData","getEntries","content_type","order","response","formatData","items","tempSorted","sort","a","b","Math","min","map","item","max","maxSize","size","setState","console","log","event","value","target","name","getProduct","element","tempProduct","product","find","resetChanges","handleChanges","checked","filterProducts","tempProducts","filter","includes","parseInt","express","require","cors","app","fetch","use","get","then","res","json","data","catch","e","tempItems","id","sys","images","fields","image","file","url","props","children","ProductConsumer","Consumer","withProductConsumer","ConsumerWrapper"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n//import items from './data';\nimport Client from './dataAPI';\n\nconst ProductContext= React.createContext();\n\nexport default class ProductProvider extends Component {\n\n    state={\n        products:[],\n        sortedProducts: [],\n        onesToWatch: [],\n        loading: true,\n        type: \"all\",\n        compatibility: \"all\",\n        brand: \"all\",\n        price: 0,\n        minPrice: 0,\n        maxPrice: 0,\n    };\n\n    //getData\n    getData = async() =>{\n        try{\n            let response = await Client.getEntries({\n                content_type: \"photoStudio\",\n                order: \"fields.price\"\n            });\n            let products=this.formatData(response.items);\n            let tempSorted=products.sort((a, b) => (a.price > b.price) ? 1 : -1);\n            let onesToWatch=[tempSorted[0], tempSorted[1], tempSorted[2]];\n            let minPrice=Math.min(...products.map(item => item.price));\n            let maxPrice=Math.max(...products.map(item => item.price));\n            let maxSize=Math.max(...products.map(item => item.size));\n            let price=maxPrice;\n\n            this.setState({\n                products,\n                sortedProducts:products,\n                onesToWatch,\n                loading:false,\n                maxPrice,\n                minPrice,\n                maxSize,\n                price\n            });\n        }catch(error){\n            console.log(error);\n        }//try_catch\n    }//getData\n\n    componentDidMount(){\n        var express = require('express')\t\n        var cors = require('cors')\t\n        var app = express()\t\n        const fetch = require('node-fetch');\t\n\n        app.use(cors())\t\n        app.get(/*'https://ghibliapi.herokuapp.com/films'*/\n        'https://nhmagqf3.api.commercecloud.salesforce.com/product/shopper-products/v1/organizations/f_ecom_bcld_s02/products')\n        .then(res => res.json())\n        .then((data) => {\n            console.log(data);\n        }).catch( e => {\n            console.log(e);\n        })\n        this.getData();\n    }//componentDidMount\n\n    sort = event => {\n        let {\n            sortedProducts\n        } = this.state;\n        const value=event.target.value;\n        if(value===\"alpha\")\n            sortedProducts=sortedProducts.sort((a, b) => (a.name > b.name) ? 1 : -1);\n        else if(value===\"price\")\n            sortedProducts=sortedProducts.sort((a, b) => (a.price > b.price) ? 1 : -1);\n        this.setState({sortedProducts:sortedProducts});\n    }//sort\n\n    formatData(items){\n        let tempItems=items.map(item =>{\n            let id=item.sys.id\n            let images=item.fields.images.map(image => image.fields.file.url);\n            let product={...item.fields,images,id};\n            return product;\n        });\n        return tempItems;\n    }//formatData\n\n    getProduct = (element) => {\n        let tempProduct=[...this.state.products];\n        const product=tempProduct.find(product => product.element === element);\n        return product;\n    }//getProduct\n\n    resetChanges = event => {\n        let{\n            products\n        } = this.state;\n        this.setState({sortedProducts:products})\n    }//resetChanges\n\n    handleChanges = event => {\n        const target=event.target;\n        const value=target.type === 'checkbox' ? target.checked : target.value;\n        const name=event.target.name;\n        this.setState({[name]:value},this.filterProducts)\n    }//handleChanges\n\n    filterProducts = () => {\n        let{\n            products,\n            type,\n            compatibility,\n            price,\n            brand\n        } = this.state;\n        let tempProducts=[...products];\n\n        //capacity\n        if(compatibility!=='all')\n            tempProducts=tempProducts.filter(product => product.compatibility.includes(compatibility))\n\n        //type\n        if(type!=='all')\n            tempProducts=tempProducts.filter(product => product.type === type);\n        \n        //price\n        price=parseInt(price);\n        tempProducts=tempProducts.filter(product => product.price <= price);\n        \n        //brand\n        if(brand!=='all')\n                tempProducts=tempProducts.filter(product => product.brand === brand)\n\n        this.setState({\n            sortedProducts:tempProducts\n        })\n    }//filterProducts\n\n    render() {\n        return (\n            <ProductContext.Provider value={{...this.state,getProduct: this.getProduct,handleChanges: this.handleChanges,resetChanges:this.resetChanges,sort:this.sort}}>\n                {this.props.children}\n            </ProductContext.Provider>\n        );\n    }//render\n}//ProductProvider\n\nconst ProductConsumer = ProductContext.Consumer;\n\nexport function withProductConsumer(Component){\n    return function ConsumerWrapper(props){\n        return(\n            <ProductConsumer>\n                {value => <Component {...props} context={value}/>}\n            </ProductConsumer>\n        )}\n}//withProductConsumer\n\nexport{ProductProvider,ProductConsumer,ProductContext}"]},"metadata":{},"sourceType":"module"}